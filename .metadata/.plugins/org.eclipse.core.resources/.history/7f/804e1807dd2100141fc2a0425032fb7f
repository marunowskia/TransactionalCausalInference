package oss.marunowskia.datamining.transactionalcausalinference.utilities;

public class QueryTextClassifier {

	public static String stripLiteralValues(String queryText) {
		StringBuffer result = new StringBuffer();
		boolean inStringLiteral = false;
		boolean inNumberSequence = false;
		for(Character c: queryText.toCharArray()) {
			if(c.equals('\'')) {
				inStringLiteral = !inStringLiteral;
				continue;
			}
			if(inStringLiteral) {
				continue;
			}
			if(Character.isDigit(c)) {
				inNumberSequence = true;
			}
			else {
				if(inNumberSequence) {
					// Each number sequence gets replaced with a single '0'
					result.append(0);
					inNumberSequence = false;
				}
				result.append(c);
			}
		}
		return result.toString();
	}
	
	public static long classifyQuery(String queryText) {
		return stripLiteralValues(queryText).hashCode();
	}
}
