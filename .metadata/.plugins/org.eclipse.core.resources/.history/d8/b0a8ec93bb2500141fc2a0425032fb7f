package oss.marunowskia.datamining.transactionalcausalinference;

import java.util.Hashtable;

import javax.annotation.PostConstruct;
import javax.ejb.Singleton;
import javax.ejb.Startup;
import javax.inject.Inject;

import org.apache.log4j.Logger;

import oss.marunowskia.datamining.transactionalcausalinference.demo.CausalInferenceDemo;
import oss.marunowskia.datamining.transactionalcausalinference.demo.FixedSequenceDemo;
import oss.marunowskia.datamining.transactionalcausalinference.utilities.*;
import oss.marunowskia.datamining.transactionalcausalinference.utilities.transactions.TransactionScanner;

@Singleton
@Startup
public class StartupSequence {

	Logger logger = Logger.getLogger(StartupSequence.class);
	@Inject
	DatabaseUtililty databaseUtility;
	
	@PostConstruct
	public void startupSequence() {

//		logger.info("StartupSequence initiated");
//		
		Hashtable<String, String> config = databaseUtility.getConfig();
		TransactionScanner transactionScanner = new TransactionScanner(config);
		databaseUtility.fetchSortedTraceDataBatches(transactionScanner);
		transactionScanner.reportResults();
		
	}
	
	public static void main(String args[]) {
		new CausalInferenceDemo().runDemo();
	}
}
